<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="">
<meta name="keywords" content=" ">
<title>Lecture 8: Python - I/O, error handling, and testing frameworks | Scientific Computing with Python</title>
<link rel="stylesheet" href="/python/css/prismOkaidia.css">
<script src="/python/js/prismOkaidia.js"></script>
<!--
<link rel="stylesheet" href="/python/css/syntax.css">
-->
<link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel="stylesheet" type="text/css" href="/python/css/bootstrap.min.css">



<link rel="stylesheet" href="/python/css/customstyles.css">
<link rel="stylesheet" href="/python/css/boxshadowproperties.css">
<!-- most color styles are extracted out to here -->
<link rel="stylesheet" href="/python/css/theme-cdslab.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
<script src="/python/js/jquery.navgoco.min.js"></script>
<!-- make sidebar non-accordion -->
<script src="/python/js/lockScrollbarPosition.js"></script>
<!-- make sidebar non-accordion -->
<script type="text/javascript">
    $(document).ready(function() {
        $('.sidenav').navgoco({
              accordion: false,
              caret: '<span class="caret"></span>',
              openClass: 'open',
              save: true,
              cookie: {
                  name: 'navgoco',
                  expires: false,
                  path: '/'
              },
              slide: {
                  duration: 400,
                  easing: 'swing'
              }
          });
    });
</script>
<!-- Latest compiled and minified JavaScript -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
<!-- Anchor.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.2.0/anchor.min.js"></script>
<!--
-->
<script src="/python/js/toc.js"></script>
<script src="/python/js/customscripts.js"></script>
<link rel="shortcut icon" href="/python/images/favicon.ico">
<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->
<link rel="alternate" type="application/rss+xml" title="documentation-theme-jekyll" href="/python/feed.xml">

    <script>
        $(document).ready(function() {
            // Initialize navgoco with default options
            $("#mysidebar").navgoco({
                caretHtml: '',
                accordion: true,
                openClass: 'active', // open
                save: false, // leave false or nav highlighting doesn't work right
                cookie: {
                    name: 'navgoco',
                    expires: false,
                    path: '/'
                },
                slide: {
                    duration: 400,
                    easing: 'swing'
                }
            });
            $("#collapseAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', false);
            });
            $("#expandAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', true);
            });
        });
    </script>
    <script>
        $(function () {
            $('[data-toggle="tooltip"]').tooltip()
        })
    </script>
    <script>
        $(document).ready(function() {
            $("#tg-sb-link").click(function() {
                $("#tg-sb-sidebar").toggle();
                $("#tg-sb-content").toggleClass('col-md-9');
                $("#tg-sb-content").toggleClass('col-md-12');
                $("#tg-sb-icon").toggleClass('fa-toggle-on');
                $("#tg-sb-icon").toggleClass('fa-toggle-off');
            });
        });
    </script>
    

</head>
<body>
<!-- Navigation -->
<nav class="navbar navbar-inverse navbar-static-top">
    <div id="sticky" class="container topnavlinks">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="fa fa-book fa-lg navbar-brand" href="/python/index.html">&nbsp;<span class="projectTitle"> Scientific Computing with Python</span></a>
        </div>
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <!-- toggle sidebar button -->
                <li><a id="tg-sb-link" href="#"><i id="tg-sb-icon" class="fa fa-toggle-on"></i> Nav</a></li>
                <!-- entries without drop-downs appear here -->




                
                <!-- entries with drop-downs appear here -->
                <!-- conditional logic to control which topnav appears for the audience defined in the configuration file.-->
                
                
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">CDSLab<b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        
                        
                        <li><a href="https://www.cdslab.org/#about" target="_blank" rel="noopener">About</a></li>
                        
                        
                        
                        <li><a href="https://www.cdslab.org/people" target="_blank" rel="noopener">People</a></li>
                        
                        
                    </ul>
                </li>
                
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Other Tutorials<b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        
                        
                        <li><a href="https://www.cdslab.org/scientific-computing-with-matlab/" target="_blank" rel="noopener">Scientific Computing with MATLAB</a></li>
                        
                        
                    </ul>
                </li>
                
                
                
			<li>



  <a class="email" title="Submit feedback" href="#" onclick="javascript:window.location='mailto:shahmoradi@utexas.edu?subject=Scientific Computing with Python feedback&body=I have some feedback about the Lecture 8: Python - I/O, error handling, and testing frameworks page: ' + window.location.href;"><i class="fa fa-envelope-o"></i> Contact</a>

</li>

		
                <!--comment out this block if you want to hide search-->
                <li>
                    <!--start search-->
                    <div id="search-demo-container">
                        <input type="text" id="search-input" placeholder="search...">
                        <ul id="results-container"></ul>
                    </div>
                    <script src="/python/js/jekyll-search.js" type="text/javascript"></script>
                    <script type="text/javascript">
                            SimpleJekyllSearch.init({
                                searchInput: document.getElementById('search-input'),
                                resultsContainer: document.getElementById('results-container'),
                                dataSource: "/python/search.json",
                                searchResultTemplate: '<li><a href="https://www.cdslab.org{url}" title="Lecture 8: Python - I/O, error handling, and testing frameworks">{title}</a></li>',
                    noResultsText: 'No results found.',
                            limit: 10,
                            fuzzy: true,
                    })
                    </script>
                    <!--end search-->
                </li>
            </ul>
        </div>
        </div>
        <!-- /.container -->
</nav>

<!-- Page Content -->
<div class="container">
  <div id="main">
    <!-- Content Row -->
    <div class="row">
        
        
            <!-- Sidebar Column -->
            <div class="col-md-3" id="tg-sb-sidebar">
                
<ul id="mysidebar" class="sidenav">
    <!--
    -->
    <li class="sidebarTitle">Table of Pages </li>
    
        
            
        
            
                <li>
                    <a title="Overview" href="#">Overview</a>
                    <ul>
                        
                                
                                    
                                        <li><a title="Preface" href="/python/notes/overview/preface/index.html">Preface</a></li>
                                    
                                    
                                
                        
                                
                                    
                                        <li><a title="Release note 1" href="/python/notes/overview/release-note-1/index.html">Release note 1</a></li>
                                    
                                    
                                
                        
                    </ul>
                </li>
            
        
            
                <li>
                    <a title="Preliminary foundations" href="#">Preliminary foundations</a>
                    <ul>
                        
                                
                                    
                                        <li><a title="Version control system" href="/python/notes/preliminary-foundations/version-control-system/index.html">Version control system</a></li>
                                    
                                    
                                
                        
                                
                                    
                                        <li><a title="Programming history" href="/python/notes/preliminary-foundations/programming-history/index.html">Programming history</a></li>
                                    
                                    
                                
                        
                                
                                    
                                        <li><a title="Computer program structure" href="/python/notes/preliminary-foundations/computer-program-structure/index.html">Computer program structure</a></li>
                                    
                                    
                                
                        
                                
                                    
                                        <li><a title="Python for beginners" href="/python/notes/preliminary-foundations/python-for-beginners/index.html">Python for beginners</a></li>
                                    
                                    
                                
                        
                    </ul>
                </li>
            
        
            
                <li>
                    <a title="Values, variables, and types" href="#">Values, variables, and types</a>
                    <ul>
                        
                                
                                    
                                        <li><a title="First Python program" href="/python/notes/values-variables-types/first-python-program/index.html">First Python program</a></li>
                                    
                                    
                                
                        
                                
                                    
                                        <li><a title="Values in Python" href="/python/notes/values-variables-types/values-in-python/index.html">Values in Python</a></li>
                                    
                                    
                                
                        
                                
                                    
                                        <li><a title="Variables in Python" href="/python/notes/values-variables-types/variables-in-python/index.html">Variables in Python</a></li>
                                    
                                    
                                
                        
                    </ul>
                </li>
            
        
            
                <li>
                    <a title="Control constructs" href="#">Control constructs</a>
                    <ul>
                        
                                
                                    
                                        <li><a title="Branching" href="/python/notes/control-constructs/branching/index.html">Branching</a></li>
                                    
                                    
                                
                        
                                
                                    
                                        <li><a title="Looping" href="/python/notes/control-constructs/looping/index.html">Looping</a></li>
                                    
                                    
                                
                        
                    </ul>
                </li>
            
        
            
                <li>
                    <a title="Program units" href="#">Program units</a>
                    <ul>
                        
                                
                                    
                                        <li><a title="Functions" href="/python/notes/program-units/functions/index.html">Functions</a></li>
                                    
                                    
                                
                        
                                
                                    
                                        <li><a title="Modules" href="/python/notes/program-units/modules/index.html">Modules</a></li>
                                    
                                    
                                
                        
                    </ul>
                </li>
            
        
            
                <li>
                    <a title="Data transfer (I/O)" href="#">Data transfer (I/O)</a>
                    <ul>
                        
                                
                                    
                                        <li><a title="Data input methods" href="/python/notes/data-transfer/input/index.html">Data input methods</a></li>
                                    
                                    
                                
                        
                                
                                    
                                        <li><a title="Data output methods" href="/python/notes/data-transfer/output/index.html">Data output methods</a></li>
                                    
                                    
                                
                        
                    </ul>
                </li>
            
        
    
    <!-- if you aren't using the accordion, uncomment this block:
    -->
    <p class="external">
        <a href="#" id="collapseAll">Collapse All</a> | <a href="#" id="expandAll">Expand All</a>
    </p>
</ul>
<!--
This highlights the active parent class in the navgoco sidebar. 
This is critical so that the parent expands when you're viewing a page.
This must appear below the sidebar code above.
Otherwise, if placed inside customscripts.js,
the script runs before the sidebar code runs and the class never gets inserted.
-->
<script>$("li.active").parents('li').toggleClass("active");</script>

            </div>
            
        

        <!-- Content Column -->
        <div class="col-md-9" id="tg-sb-content">
            <article class="post" itemscope itemtype="https://schema.org/BlogPosting">

    <header class="post-header">
        <h1 class="post-title" itemprop="name headline">Lecture 8: Python - I/O, error handling, and testing frameworks</h1>
        <p class="post-meta"><time datetime="" itemprop="datePublished"></time> 

        </p>


    </header>

    <div class="post-content" itemprop="articleBody">

        

        <p>This lecture further explains topics on Input/Output processes and error handling in Python, as well as methods of testing the accuracy and robustness of your code.</p>

<div class="post_toc"></div>

<h2 id="io-continued">I/o (continued)</h2>
<p>So far in this course, we have indirectly discussed several methods of getting input information from the user, and several methods of outputting the result in a Python program. This lecture, attempts at formalizing all the previous discussions and introduce more general efficient methods of the code interaction with users.</p>

<h3 id="methods-of-inputting-data">Methods of inputting data</h3>
<p>Let’s begin with an example code, explaining the meaning of input/output (I/O) in Python,</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">exp</span>
<span class="n">a</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">b</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">x</span> <span class="o">=</span> <span class="mf">0.6</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="n">b</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</code></pre></div></div>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0.1822118800390509
</code></pre></div></div>

<p>In the above code, $a,b,x$ are examples of input data to a code, and $y$ is an example of code output. In such case as in the above, the input data is said to be <strong>hardcoded</strong> in the program.</p>

<blockquote>
    <b>In general, in any programming language, including Python you should always avoid hardcoding input information into your program.</b><br /><br />
    If data is hardcoded, then every time it has to change, the user has to change the content of the code, and this is not considered good programming style for software development.
</blockquote>
<p><br />
In general, input data can be fed to a program in four different ways:</p>
<ol>
  <li>let the user answer questions in a dialog in the <strong>terminal window</strong>,</li>
  <li>let the user provide input on the <strong>command line</strong>,</li>
  <li>let the user provide input data in a <strong>file</strong>,</li>
  <li>let the user write input data in a <strong>graphical interface</strong>.</li>
</ol>

<h4 id="input-data-from-terminal-window">Input data from terminal window</h4>
<p>We have already introduced and used this method frequently in previous lectures, via the Python’s builtin function <code class="highlighter-rouge">input()</code>. If we were to get the input data for the above example code via the terminal window, an example would be the following,</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">exp</span>
<span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">x</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s">'input the values for a,b,x (comma separated): '</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">","</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="o">*</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</code></pre></div></div>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>input the values for a,b,x (comma separated): 0.1,1,0.6
0.1822118800390509
</code></pre></div></div>

<h4 id="input-data-from-command-line">Input data from command line</h4>

<p>This approach, which we discussed in previous lecture, is most popular in Unix-like environments, where most users are accustomed to using Bash command line. However, it can be readily used in Windows environment as well. For this approach, there is a Python module <code class="highlighter-rouge">sys</code> that can accomplish what we desire,</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">exp</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">x</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="o">*</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</code></pre></div></div>
<p><br />
Now if you save this code in a <a href="https://www.cdslab.org/lecture/8/input_via_sys.py" target="_blank">file</a>, and run it on the Bash command line, the program expects you the enter 3 float numbers following the name of the program,</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>python input_via_sys.py 0.1 1 0.6
0.1822118800390509
</code></pre></div></div>
<p><br /></p>
<blockquote>
    <b>ATTENTION: Notice the convention for command-line arguments</b><br /><br />
    
    <b>1.</b> As you see in the above example, the name of the program is considered as the first command line argument (<code>sys.argv[0]</code>). Also the arguments must be separated by a white space, and should appear in the proper order.<br /><br />
    
    <b>2.</b> If one value has a white space (e.g., a string value with white space character in it), then it has to be contained in quotation marks <code>''</code> or <code>""</code>.<br /><br />
    
    <b>3.</b> Also note that all input command-line arguments are taken as string values. Therefore, you will have to convert them to the proper type (e.g., float, int, ...) once they are read from the command line.
</blockquote>
<p><br /></p>

<h5 id="variable-number-of-command-line-arguments">Variable number of command line arguments</h5>
<p>If the number of input arguments on the command line is not known a priori, then you can get a list of all input arguments using <code class="highlighter-rouge">sys.argv[1:]</code> and then use a for-loop to loop over individual elements of it, or use <code class="highlighter-rouge">len()</code> function to find the total number of input arguments.<br />
<br /></p>

<h5 id="option-value-pairs-as-command-line-input">Option-value pairs as command-line input</h5>
<p>Once the number of input arguments to your code increases, the process of inputting data as command line arguments can get complicated. Ideally, the user should be able to enter data in any arbitrary order. This can be done by indicating the meaning of each input by a flag before the input value. For example, suppose you were to find the location $y(t)$ of an object thrown up in the air vertically, given that the object started at $y=y_0$, at $t=0$ with an initial velocity $v_0$, and thereafter was subject to a constant acceleration $a$,
<script type="math/tex">y(t) = y_0 + v_0t + \frac{1}{2}at^2 ~.</script>
Obviously, this formula requires four input variables: $y_0$, $v_0$, $a$, and $t$, and we don’t the program user to memorize their order of entry on the command line. The solution is to identify the type of each input using a flag preceding the input value. This can be done using <code class="highlighter-rouge">argparse</code> Python module. Details of the usage of this module goes beyond the limited time of our class. However, I recommend you to have a look at the <a href="https://docs.python.org/3/library/argparse.html" target="_blank">syntax and usage of <em>argparse</em> module</a>, as you will find it very handy in your Python codes, projects, and software development.</p>

<h4 id="input-data-from-file">Input data from file</h4>
<p>In cases where the input data is large, the command-line arguments and input from terminal window are not efficient anymore. In such cases, the most common approach is to let the code read input data from a file, the path to which is most often given to the code from the command line or the terminal window.</p>

<h5 id="reading-a-file-line-by-line">Reading a file line by line</h5>
<p>To read a file, say <a href="https://www.cdslab.org/lecture/8/data.in" target="_blank">this file</a>, one first needs to open it,</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">In</span> <span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="n">myfile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">'data.in'</span><span class="p">,</span> <span class="s">'r'</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="nb">type</span><span class="p">(</span><span class="n">myfile</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="n">_io</span><span class="o">.</span><span class="n">TextIOWrapper</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">5</span><span class="p">]:</span> <span class="n">myfile</span><span class="o">.</span>
     <span class="n">myfile</span><span class="o">.</span><span class="nb">buffer</span>         <span class="n">myfile</span><span class="o">.</span><span class="n">detach</span>         <span class="n">myfile</span><span class="o">.</span><span class="n">fileno</span>         <span class="n">myfile</span><span class="o">.</span><span class="n">line_buffering</span> <span class="n">myfile</span><span class="o">.</span><span class="n">newlines</span>       <span class="n">myfile</span><span class="o">.</span><span class="n">readline</span>       <span class="n">myfile</span><span class="o">.</span><span class="n">seekable</span>       <span class="n">myfile</span><span class="o">.</span><span class="n">writable</span>
     <span class="n">myfile</span><span class="o">.</span><span class="n">close</span>          <span class="n">myfile</span><span class="o">.</span><span class="n">encoding</span>       <span class="n">myfile</span><span class="o">.</span><span class="n">flush</span>          <span class="n">myfile</span><span class="o">.</span><span class="n">mode</span>           <span class="n">myfile</span><span class="o">.</span><span class="n">read</span>           <span class="n">myfile</span><span class="o">.</span><span class="n">readlines</span>      <span class="n">myfile</span><span class="o">.</span><span class="n">tell</span>           <span class="n">myfile</span><span class="o">.</span><span class="n">write</span>
     <span class="n">myfile</span><span class="o">.</span><span class="n">closed</span>         <span class="n">myfile</span><span class="o">.</span><span class="n">errors</span>         <span class="n">myfile</span><span class="o">.</span><span class="n">isatty</span>         <span class="n">myfile</span><span class="o">.</span><span class="n">name</span>           <span class="n">myfile</span><span class="o">.</span><span class="n">readable</span>       <span class="n">myfile</span><span class="o">.</span><span class="n">seek</span>           <span class="n">myfile</span><span class="o">.</span><span class="n">truncate</span>       <span class="n">myfile</span><span class="o">.</span><span class="n">writelines</span>

</code></pre></div></div>
<p><br />
The function <code class="highlighter-rouge">open</code> creates a file object, stored in the variable <code class="highlighter-rouge">myfile</code>. The second input argument to <code class="highlighter-rouge">open</code>, <code class="highlighter-rouge">'r'</code> tells the function that the purpose of this file opening is to read data (as opposed to, for example, writing data, or both reading and writing).</p>

<p>Now you can use a for loop to read the data in this file line by line:</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">myfile</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</code></pre></div></div>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1

3

4

5

6

7

88

65
</code></pre></div></div>

<p>What is printed here, is actually the content of <code class="highlighter-rouge">data.in</code> file, line by line.</p>

<h5 id="alternative-method-of-reading-file-data">Alternative method of reading file data</h5>
<p>Instead of reading one line at a time, as in the above, we can load all lines into a single list of strings,</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">In</span> <span class="p">[</span><span class="mi">9</span><span class="p">]:</span> <span class="n">myfile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">'data.in'</span><span class="p">,</span> <span class="s">'r'</span><span class="p">)</span>
<span class="n">In</span> <span class="p">[</span><span class="mi">10</span><span class="p">]:</span> <span class="n">lines</span> <span class="o">=</span> <span class="n">myfile</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">11</span><span class="p">]:</span> <span class="nb">type</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">11</span><span class="p">]:</span> <span class="nb">list</span>
</code></pre></div></div>
<p><br />
Note that each element of <code class="highlighter-rouge">line</code> contains one line of the file.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">In</span> <span class="p">[</span><span class="mi">15</span><span class="p">]:</span> <span class="n">lines</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">15</span><span class="p">]:</span> <span class="p">[</span><span class="s">'1</span><span class="se">\n</span><span class="s">'</span><span class="p">,</span> <span class="s">'3</span><span class="se">\n</span><span class="s">'</span><span class="p">,</span> <span class="s">'4</span><span class="se">\n</span><span class="s">'</span><span class="p">,</span> <span class="s">'5</span><span class="se">\n</span><span class="s">'</span><span class="p">,</span> <span class="s">'6</span><span class="se">\n</span><span class="s">'</span><span class="p">,</span> <span class="s">'7</span><span class="se">\n</span><span class="s">'</span><span class="p">,</span> <span class="s">'88</span><span class="se">\n</span><span class="s">'</span><span class="p">,</span> <span class="s">'65</span><span class="se">\n</span><span class="s">'</span><span class="p">]</span>
</code></pre></div></div>
<p><br />
The action of the method <code class="highlighter-rouge">readlines()</code> is equivalent to a for-loop like the following,</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">In</span> <span class="p">[</span><span class="mi">16</span><span class="p">]:</span> <span class="n">myfile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">'data.in'</span><span class="p">,</span> <span class="s">'r'</span><span class="p">)</span>
    <span class="o">...</span><span class="p">:</span> <span class="n">lines</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="o">...</span><span class="p">:</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">myfile</span><span class="p">:</span>
    <span class="o">...</span><span class="p">:</span>     <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
    <span class="o">...</span><span class="p">:</span> <span class="n">lines</span>
    <span class="o">...</span><span class="p">:</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">16</span><span class="p">]:</span> <span class="p">[</span><span class="s">'1</span><span class="se">\n</span><span class="s">'</span><span class="p">,</span> <span class="s">'3</span><span class="se">\n</span><span class="s">'</span><span class="p">,</span> <span class="s">'4</span><span class="se">\n</span><span class="s">'</span><span class="p">,</span> <span class="s">'5</span><span class="se">\n</span><span class="s">'</span><span class="p">,</span> <span class="s">'6</span><span class="se">\n</span><span class="s">'</span><span class="p">,</span> <span class="s">'7</span><span class="se">\n</span><span class="s">'</span><span class="p">,</span> <span class="s">'88</span><span class="se">\n</span><span class="s">'</span><span class="p">,</span> <span class="s">'65</span><span class="se">\n</span><span class="s">'</span><span class="p">]</span>
</code></pre></div></div>
<p><br />
or this <em>list comprehension</em> format,</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">In</span> <span class="p">[</span><span class="mi">19</span><span class="p">]:</span> <span class="n">myfile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">'data.in'</span><span class="p">,</span> <span class="s">'r'</span><span class="p">)</span>
    <span class="o">...</span><span class="p">:</span> <span class="n">lines</span> <span class="o">=</span> <span class="p">[</span><span class="n">line</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">myfile</span><span class="p">]</span>
    <span class="o">...</span><span class="p">:</span> <span class="n">lines</span>
    <span class="o">...</span><span class="p">:</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">19</span><span class="p">]:</span> <span class="p">[</span><span class="s">'1</span><span class="se">\n</span><span class="s">'</span><span class="p">,</span> <span class="s">'3</span><span class="se">\n</span><span class="s">'</span><span class="p">,</span> <span class="s">'4</span><span class="se">\n</span><span class="s">'</span><span class="p">,</span> <span class="s">'5</span><span class="se">\n</span><span class="s">'</span><span class="p">,</span> <span class="s">'6</span><span class="se">\n</span><span class="s">'</span><span class="p">,</span> <span class="s">'7</span><span class="se">\n</span><span class="s">'</span><span class="p">,</span> <span class="s">'88</span><span class="se">\n</span><span class="s">'</span><span class="p">,</span> <span class="s">'65</span><span class="se">\n</span><span class="s">'</span><span class="p">]</span>
</code></pre></div></div>
<p><br />
Now suppose you were to calculate the mean of the numbers in <a href="https://www.cdslab.org/lecture/8/data.in" target="_blank">this file</a>. You could simply use the following list comprehension code to do so,</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">In</span> <span class="p">[</span><span class="mi">22</span><span class="p">]:</span> <span class="n">mean</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">])</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>
    <span class="o">...</span><span class="p">:</span> <span class="k">print</span><span class="p">(</span><span class="n">mean</span><span class="p">)</span>
<span class="mf">22.375</span>
</code></pre></div></div>
<p><br />
Note that once you read the file, you can close it using,</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">myfile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div></div>
<p><br /></p>

<h5 id="the-with-statement">The <em>with</em> statement</h5>
<p>More often in modern Python code you may see the <code class="highlighter-rouge">with</code> statement for reading a file, like the following</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">In</span> <span class="p">[</span><span class="mi">34</span><span class="p">]:</span> <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">'data.in'</span><span class="p">,</span> <span class="s">'r'</span><span class="p">)</span> <span class="k">as</span> <span class="n">myfile</span><span class="p">:</span>
    <span class="o">...</span><span class="p">:</span>     <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">myfile</span><span class="p">:</span>
    <span class="o">...</span><span class="p">:</span>         <span class="k">print</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
    <span class="o">...</span><span class="p">:</span>
<span class="mi">1</span>

<span class="mi">3</span>

<span class="mi">4</span>

<span class="mi">5</span>

<span class="mi">6</span>

<span class="mi">7</span>

<span class="mi">88</span>

<span class="mi">65</span>
</code></pre></div></div>
<p><br />
This is technically equivalent to,</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">In</span> <span class="p">[</span><span class="mi">35</span><span class="p">]:</span> <span class="n">myfile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">'data.in'</span><span class="p">,</span> <span class="s">'r'</span><span class="p">)</span>
    <span class="o">...</span><span class="p">:</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">myfile</span><span class="p">:</span>
    <span class="o">...</span><span class="p">:</span>     <span class="k">print</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
    <span class="o">...</span><span class="p">:</span> <span class="n">myfile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="o">...</span><span class="p">:</span>
<span class="mi">1</span>

<span class="mi">3</span>

<span class="mi">4</span>

<span class="mi">5</span>

<span class="mi">6</span>

<span class="mi">7</span>

<span class="mi">88</span>

<span class="mi">65</span>
</code></pre></div></div>
<p><br />
The difference here is that with the modern <code class="highlighter-rouge">with</code> statement, there is no need to close the file in the end.</p>

<h5 id="the-old-while-true-construction">The old <em>while True</em> construction</h5>
<p>The call <code class="highlighter-rouge">myfile.readline()</code> returns a string containing the text at the current line. A new <code class="highlighter-rouge">myfile.readline()</code> statement will read the next line. If the file reaches the end, then <code class="highlighter-rouge">myfile.readline()</code> returns an empty string, the end of the file has
reached and the code must stop further reading of the file. The traditional way of telling the code to stop at the end of the file is a <code class="highlighter-rouge">while</code> loop like the following,</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">In</span> <span class="p">[</span><span class="mi">36</span><span class="p">]:</span> <span class="n">myfile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">'data.in'</span><span class="p">,</span> <span class="s">'r'</span><span class="p">)</span>
    <span class="o">...</span><span class="p">:</span> <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
    <span class="o">...</span><span class="p">:</span>     <span class="n">line</span> <span class="o">=</span> <span class="n">myfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
    <span class="o">...</span><span class="p">:</span>     <span class="k">if</span> <span class="ow">not</span> <span class="n">line</span><span class="p">:</span>
    <span class="o">...</span><span class="p">:</span>         <span class="k">break</span>
    <span class="o">...</span><span class="p">:</span>     <span class="k">print</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
<span class="mi">1</span>

<span class="mi">3</span>

<span class="mi">4</span>

<span class="mi">5</span>

<span class="mi">6</span>

<span class="mi">7</span>

<span class="mi">88</span>

<span class="mi">65</span>
</code></pre></div></div>
<p><br /></p>

<h5 id="reading-an-entire-file-as-a-single-string">Reading an entire file as a single string</h5>
<p>While the <code class="highlighter-rouge">readlines()</code> method returns a list of lines in the file, the <code class="highlighter-rouge">read()</code> method returns a string containing the entire content of the file.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="n">In</span> <span class="p">[</span><span class="mi">37</span><span class="p">]:</span> <span class="n">myfile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">'data.in'</span><span class="p">,</span> <span class="s">'r'</span><span class="p">)</span>
    <span class="o">...</span><span class="p">:</span> <span class="n">s</span> <span class="o">=</span> <span class="n">myfile</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">38</span><span class="p">]:</span> <span class="n">s</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">38</span><span class="p">]:</span> <span class="s">'1</span><span class="se">\n</span><span class="s">3</span><span class="se">\n</span><span class="s">4</span><span class="se">\n</span><span class="s">5</span><span class="se">\n</span><span class="s">6</span><span class="se">\n</span><span class="s">7</span><span class="se">\n</span><span class="s">88</span><span class="se">\n</span><span class="s">65</span><span class="se">\n</span><span class="s">'</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">39</span><span class="p">]:</span> <span class="k">print</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="mi">1</span>
<span class="mi">3</span>
<span class="mi">4</span>
<span class="mi">5</span>
<span class="mi">6</span>
<span class="mi">7</span>
<span class="mi">88</span>
<span class="mi">65</span>
</code></pre></div></div>
<p><br />
The major advantage of this method of reading file content is that you can then immediately apply string methods directly on the file content.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">In</span> <span class="p">[</span><span class="mi">48</span><span class="p">]:</span> <span class="n">myfile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">'data.in'</span><span class="p">,</span> <span class="s">'r'</span><span class="p">)</span>
    <span class="o">...</span><span class="p">:</span> <span class="n">numbers</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">myfile</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()]</span>
    <span class="o">...</span><span class="p">:</span> <span class="n">mean</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">numbers</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">numbers</span><span class="p">)</span>
    <span class="o">...</span><span class="p">:</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">49</span><span class="p">]:</span> <span class="k">print</span><span class="p">(</span><span class="n">mean</span><span class="p">)</span>
<span class="mf">22.375</span>
</code></pre></div></div>
<p><br /></p>

<h3 id="converting-user-input-to-live-python-objects">Converting user input to live Python objects</h3>
<p>One of the cool features in Python I/O is that you can provide text containing valid Python code as input to a program and then
turn that text into <em>live Python objects</em> as if the text were lines of code written directly into the program beforehand. This is a very powerful tool for letting users specify function formulas, for instance, as input to a program. The program code itself has no knowledge about the kind of function the user wants to work with, yet at run time the user’s desired
formula enters the computations. To achieve the goal, one can use Python’s <strong>magic functions</strong>, a.k.a. <strong>special methods</strong>.</p>

<h4 id="the-magic-eval-function">The magic <em>eval</em> function</h4>
<p>The <code class="highlighter-rouge">eval</code> function takes a <strong>string as argument</strong> and <strong>evaluates</strong> this string as a <strong>Python expression</strong>. The result of an expression is an <strong>object</strong>. For example,</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">In</span> <span class="p">[</span><span class="mi">10</span><span class="p">]:</span> <span class="nb">eval</span><span class="p">(</span><span class="s">'1+2'</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">10</span><span class="p">]:</span> <span class="mi">3</span>
</code></pre></div></div>
<p><br />
This is equivalent to typing,</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">In</span> <span class="p">[</span><span class="mi">11</span><span class="p">]:</span> <span class="mi">1</span><span class="o">+</span><span class="mi">2</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">11</span><span class="p">]:</span> <span class="mi">3</span>
</code></pre></div></div>
<p><br />
or another example,</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">In</span> <span class="p">[</span><span class="mi">12</span><span class="p">]:</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">13</span><span class="p">]:</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">2</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">14</span><span class="p">]:</span> <span class="n">c</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="s">'a+b'</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">15</span><span class="p">]:</span> <span class="n">c</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">15</span><span class="p">]:</span> <span class="mi">3</span>
</code></pre></div></div>
<p><br />
or,</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">In</span> <span class="p">[</span><span class="mi">19</span><span class="p">]:</span> <span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">sqrt</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">20</span><span class="p">]:</span> <span class="nb">eval</span><span class="p">(</span><span class="s">'sqrt(4)'</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">20</span><span class="p">]:</span> <span class="mf">2.0</span>
</code></pre></div></div>
<p><br />
But, note that in all of the above examples, the <code class="highlighter-rouge">eval</code> function <strong>evaluates</strong> a Python expression, that is, this function <strong>cannot execute</strong> a Python statement.</p>

<p>Now the cool thing about this function is that, you can directly apply it to the user input. For example, suppose the user is asked to input a Python expression and then the code is supposed to evaluate the input just like a simple calculator,</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">eval</span><span class="p">(</span><span class="nb">input</span><span class="p">(</span><span class="s">'Input an arithmetic expression to evaluate: '</span><span class="p">))</span>
</code></pre></div></div>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Input an arithmetic expression to evaluate: 2 + 3.0/5 + exp(7)
1099.2331584284584
</code></pre></div></div>

<h4 id="the-magic-exec-function">The magic <em>exec</em> function</h4>
<p>Similar to the <code class="highlighter-rouge">eval</code> function, there is also an <code class="highlighter-rouge">exec</code> magic function that executes a string containing an arbitrary
Python code, not just a Python expression. This is a powerful idea since it now enables the user to write a formula as input to the program, available to the program in the form of a string object. The program can then convert this formula to a callable Python code, or function, using the magic <code class="highlighter-rouge">exec</code> function.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">In</span> <span class="p">[</span><span class="mi">21</span><span class="p">]:</span> <span class="k">exec</span><span class="p">(</span><span class="s">'import math'</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">22</span><span class="p">]:</span> <span class="k">exec</span><span class="p">(</span><span class="s">'a=1; b=2; c=a+b'</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">23</span><span class="p">]:</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">23</span><span class="p">]:</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</code></pre></div></div>
<p><br />
One could even input a full function definition to the exec function,</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">myFuncString</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s">'Input a Python function definition of interest: '</span><span class="p">)</span>
<span class="n">f</span> <span class="o">=</span> <span class="k">exec</span><span class="p">(</span><span class="n">myFuncString</span><span class="p">)</span>
</code></pre></div></div>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Input a Python function definition of interest, named func: def func(x): return 2*x + 1  
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">func</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></div>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>3
</code></pre></div></div>

<p>Now, since this is such a useful functionality in Python, there is already a package written <code class="highlighter-rouge">scitools</code>, that converts an input expression to a Python function,</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">scitools.StringFunction</span> <span class="kn">import</span> <span class="n">StringFunction</span>
<span class="n">myfuncString</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s">'Input a Python expression to build your requested Python function: '</span><span class="p">)</span>
<span class="n">myfunc</span> <span class="o">=</span> <span class="n">StringFunction</span><span class="p">(</span><span class="n">myfuncString</span><span class="p">)</span>
</code></pre></div></div>
<p><br />
The only major caveat with this module is that, at the moment, it only works with Python 2.x, and not Python 3. So, the above code will not work on your Python 3 platform.<br />
<br /></p>

<h3 id="methods-of-outputting-data">Methods of outputting data</h3>
<p>Two major methods of data output are,</p>
<ol>
  <li>writing to the terminal window, as previously done using <code class="highlighter-rouge">print()</code> function, or,</li>
  <li>writing to an output file.</li>
</ol>

<p>We have already extensively discussed printing output to the terminal window. Writing data to file is also easy.</p>

<h4 id="writing-to-a-file">Writing to a file</h4>
<p>Similar to reading from a file, in order to write to a file, one has to first open the file, this time for the purpose of writing, which is indicated by <code class="highlighter-rouge">'w'</code> or <code class="highlighter-rouge">'a'</code>,</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">outfile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s">'w'</span><span class="p">)</span> <span class="c"># write to a new file, or overwrite file</span>
</code></pre></div></div>
<p><br />
One could also <strong>append</strong> some output to an <strong>existing file</strong> using the <code class="highlighter-rouge">'a'</code> indicator as input to <code class="highlighter-rouge">open()</code>,</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">outfile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s">'a'</span><span class="p">)</span> <span class="c"># append to the end of an existing file</span>
</code></pre></div></div>
<p><br />
In both cases, the string valued variable <code class="highlighter-rouge">filename</code> contains the path to the file that should be created or manipulated. Suppose we want to write the output of the above code in previous section to a new file. All you would need to do is the following,</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">myfile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">'data.in'</span><span class="p">,</span> <span class="s">'r'</span><span class="p">)</span>
<span class="n">numbers</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">myfile</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()]</span>
<span class="n">mean</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">numbers</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">numbers</span><span class="p">)</span>
<span class="n">outfile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">'data.out'</span><span class="p">,</span><span class="s">'w'</span><span class="p">)</span>
<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">mean</span><span class="p">)</span> <span class="o">+</span> <span class="s">'</span><span class="se">\n</span><span class="s">'</span><span class="p">)</span>
<span class="n">myfile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="n">outfile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div></div>
<p><br />
This will result in the creation of <a href="https://www.cdslab.org/lecture/8/data.out" target="_blank">a new file</a> named <code class="highlighter-rouge">data.out</code> which contains the value of <code class="highlighter-rouge">mean</code> variable. Note that the addition of the character <code class="highlighter-rouge">'\n'</code> at the end of the <code class="highlighter-rouge">write</code> statement is necessary, otherwise the next write to the file will not appear on a new line.</p>

<h5 id="writing-a-table-of-data-to-a-file">Writing a table of data to a file</h5>
<p>Now suppose you were to write the following list to an output file,</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">data</span> <span class="o">=</span> <span class="p">[[</span> <span class="mf">0.75</span><span class="p">,</span> <span class="mf">0.29619813</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.29619813</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.75</span> <span class="p">],</span>
<span class="p">[</span> <span class="mf">0.29619813</span><span class="p">,</span> <span class="mf">0.11697778</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.11697778</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.29619813</span><span class="p">],</span>
<span class="p">[</span><span class="o">-</span><span class="mf">0.29619813</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.11697778</span><span class="p">,</span> <span class="mf">0.11697778</span><span class="p">,</span> <span class="mf">0.29619813</span><span class="p">],</span>
<span class="p">[</span><span class="o">-</span><span class="mf">0.75</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.29619813</span><span class="p">,</span> <span class="mf">0.29619813</span><span class="p">,</span> <span class="mf">0.75</span> <span class="p">]]</span>
</code></pre></div></div>
<p><br />
One solution would be the following,</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">outfile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">'table.out'</span><span class="p">,</span> <span class="s">'w'</span><span class="p">)</span>
<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">row</span><span class="p">:</span>
        <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span> <span class="s">'{:14.8f}'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">column</span><span class="p">)</span> <span class="p">)</span>
    <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">'</span><span class="se">\n</span><span class="s">'</span><span class="p">)</span>
<span class="n">outfile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div></div>
<p><br />
This code would result in the creation of an <a href="https://www.cdslab.org/lecture/8/table.out" target="_blank">output file</a> named <code class="highlighter-rouge">table.out</code> which contain the content of <code class="highlighter-rouge">data</code> variable, in a nice formatted style as the following,</p>
<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    0.75000000    0.29619813   -0.29619813   -0.75000000
    0.29619813    0.11697778   -0.11697778   -0.29619813
   -0.29619813   -0.11697778    0.11697778    0.29619813
   -0.75000000   -0.29619813    0.29619813    0.75000000
</code></pre></div></div>
<p><br /></p>

<h2 id="error-handling-in-python">Error handling in Python</h2>
<p>A good code has to be able to handle exceptional situations that may occur during the code execution. These exceptions may occur during data input from either command line, terminal window, or an input file. They may also occur as a result of repeated operations on the input data, inside the code. For example, in <a href="https://www.cdslab.org/lecture/7-python-modules-loops-io#command-line-arguments" target="_blank">lecture 7</a>, we explained a way of handling the wrong number of input command line arguments. This and similar measures to handle nicely the unexpected runtime errors is what’s called <strong>error and exception handling</strong>.</p>

<p>A simple way of error handling is to write multiple if-blocks each of which handle a special exceptional situation. That is, to let the code execute some statements, and if something goes wrong, write the program in such a way that can detect this and jump to a set of statements that handle the erroneous situation as desired.</p>

<p>A more modern and flexible way of handling such potential errors in Python is through the following Python construction,</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">try</span><span class="p">:</span>
    <span class="o">&lt;</span><span class="n">Python</span> <span class="n">statements</span><span class="o">&gt;</span>
<span class="k">except</span> <span class="o">&lt;</span><span class="n">error</span> <span class="nb">type</span><span class="o">&gt;</span><span class="p">:</span>
    <span class="o">&lt;</span><span class="n">Python</span> <span class="n">statements</span><span class="o">&gt;</span>
</code></pre></div></div>
<p><br />
For example, if we were to rewrite the command line argument section in <a href="https://www.cdslab.org/lecture/7/cmd_find_primes.py" target="_blank">this code</a> in <a href="https://www.cdslab.org/lecture/7-python-modules-loops-io#command-line-arguments" target="_blank">lecture 7</a>, to handle exceptions that arise due to <code class="highlighter-rouge">ValueError</code> (e.g., not an integer input), it would look something like the following,</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">sys</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span> <span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span> <span class="c"># check the number of arguments to be exactly 2.</span>
        <span class="k">print</span><span class="p">(</span><span class="s">'''
    Error: Exactly two arguments must be given on the command line.
    Usage:'''</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"     "</span><span class="p">,</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s">"&lt;a positive integer number&gt;"</span><span class="p">,</span> <span class="s">'</span><span class="se">\n</span><span class="s">'</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="nb">exit</span><span class="p">(</span><span class="s">'     Program stopped.</span><span class="se">\n</span><span class="s">'</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">n</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="k">print</span><span class="p">(</span><span class="s">'Here is a list of all prime numbers smaller than {}:'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
            <span class="n">get_primes</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
        <span class="k">except</span> <span class="nb">ValueError</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">'The input you entered is not an integer!</span><span class="se">\n</span><span class="s"> Try again...'</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="nb">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></div>
<p><br />
The statement <code class="highlighter-rouge">sys.exit(1)</code> aborts the program. The whole code can be found <a href="https://www.cdslab.org/lecture/8/cmd_find_primes_modern.py" target="_blank">here</a>. Now if we run the <a href="https://www.cdslab.org/lecture/7/cmd_find_primes.py" target="_blank">original code</a> with a non-integer input, we would get the following Python error,</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>../7/cmd_find_primes.py amir
Traceback <span class="o">(</span>most recent call last<span class="o">)</span>:
  File <span class="s2">"../7/cmd_find_primes.py"</span>, line 34, <span class="k">in</span> &lt;module&gt;
    n <span class="o">=</span> int<span class="o">(</span>sys.argv[1]<span class="o">)</span>
ValueError: invalid literal <span class="k">for </span>int<span class="o">()</span> with base 10: <span class="s1">'amir'</span>
</code></pre></div></div>
<p><br />
whereas, if we run the <a href="https://www.cdslab.org/lecture/8/cmd_find_primes_modern.py" target="_blank">newly written code</a>, the non-integer error is noicely handled by outputting a gentle error message to the user and exiting the program gracefully.</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>./cmd_find_primes_modern.py amir
The input you entered is not an integer!
 Try again...
</code></pre></div></div>
<p><br />
The type of error occurring in the above example was <code class="highlighter-rouge">ValueError</code>. There can be however, many other types of errors and exceptions. For this reason, Python has a <a href="https://docs.python.org/2/library/exceptions.html" target="_blank">builtin list of exceptions</a> that frequently occur in programming.</p>

<h3 id="the-raise-statement">The <em>raise</em> statement</h3>
<p>Instead of the print statement in the above <code class="highlighter-rouge">except</code> block, Python has a builtin function to handle the error together with an input message from the programmer. For example, the previous code, could be modified to the following code,</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">sys</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span> <span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span> <span class="c"># check the number of arguments to be exactly 2.</span>
        <span class="k">print</span><span class="p">(</span><span class="s">'''
    Error: Exactly two arguments must be given on the command line.
    Usage:'''</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"     "</span><span class="p">,</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s">"&lt;a positive integer number&gt;"</span><span class="p">,</span> <span class="s">'</span><span class="se">\n</span><span class="s">'</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="nb">exit</span><span class="p">(</span><span class="s">'     Program stopped.</span><span class="se">\n</span><span class="s">'</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">n</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="k">print</span><span class="p">(</span><span class="s">'Here is a list of all prime numbers smaller than {}:'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
            <span class="n">get_primes</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
        <span class="k">except</span> <span class="nb">ValueError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="nb">ValueError</span><span class="p">(</span><span class="s">'The input you entered is not an integer!</span><span class="se">\n</span><span class="s"> Try again...'</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="nb">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></div>
<p><br />
Executing the <a href="https://www.cdslab.org/lecture/8/cmd_find_primes_raise.py" target="_blank">code</a> with wrong input would give,</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>./cmd_find_primes_raise.py amir
Traceback <span class="o">(</span>most recent call last<span class="o">)</span>:
  File <span class="s2">"./cmd_find_primes_raise.py"</span>, line 35, <span class="k">in</span> &lt;module&gt;
    n <span class="o">=</span> int<span class="o">(</span>sys.argv[1]<span class="o">)</span>
ValueError: invalid literal <span class="k">for </span>int<span class="o">()</span> with base 10: <span class="s1">'amir'</span>

During handling of the above exception, another exception occurred:

Traceback <span class="o">(</span>most recent call last<span class="o">)</span>:
  File <span class="s2">"./cmd_find_primes_raise.py"</span>, line 39, <span class="k">in</span> &lt;module&gt;
    raise ValueError<span class="o">(</span><span class="s1">'The input you entered is not an integer!\n Try again...'</span><span class="o">)</span>
ValueError: The input you entered is not an integer!
 Try again...
</code></pre></div></div>
<p><br />
A more elegant and cleaner way of handling and outputting the error would be use the following syntax, in <a href="https://www.cdslab.org/lecture/8/cmd_find_primes_raise_as_err.py" target="_blank">this modified code</a>,</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">sys</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span> <span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span> <span class="c"># check the number of arguments to be exactly 2.</span>
        <span class="k">print</span><span class="p">(</span><span class="s">'''
    Error: Exactly two arguments must be given on the command line.
    Usage:'''</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"     "</span><span class="p">,</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s">"&lt;a positive integer number&gt;"</span><span class="p">,</span> <span class="s">'</span><span class="se">\n</span><span class="s">'</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="nb">exit</span><span class="p">(</span><span class="s">'     Program stopped.</span><span class="se">\n</span><span class="s">'</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">n</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="k">print</span><span class="p">(</span><span class="s">'Here is a list of all prime numbers smaller than {}:'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
            <span class="n">get_primes</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
        <span class="k">except</span> <span class="nb">ValueError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="nb">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></div>
<p><br />
With the following output,</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>./cmd_find_primes_raise_as_err.py amir
invalid literal <span class="k">for </span>int<span class="o">()</span> with base 10: <span class="s1">'amir'</span>
</code></pre></div></div>
<p><br />
In the statement <code class="highlighter-rouge">except ValueError as err:</code> one could use <code class="highlighter-rouge">Exception</code> for all types of errors instead of only <code class="highlighter-rouge">ValueError</code> exceptions, or use a tuple syntax such as <code class="highlighter-rouge">except (ValueError, IndexError) as err:</code> to cover these two exceptions.</p>

<h2 id="code-verification-and-unit-testing">Code verification and unit testing</h2>
<p>In the previous lecture we discussed the process of creating modules and collecting functions in one file as a personal module to be used later. As soon as the list of your codes and functions grow, you will need to have a unified way of ensuring all your functions work appropriately, regardless of the potential future internal changes that are made to the functions. This is what the <strong>unit testing</strong> exists for. Unit testing is a software development process in which the smallest testable parts of an application, called <strong>units</strong>, are individually and independently scrutinized for proper operation. Unit testing can be done manually, but if you have a long list of functions (which you most often have), you’d want to automate the testing process.</p>

<p>The grand goal in unit testing is to reduce the risk of encountering potential problems when running the code in the smallest possible units of the code. This means,</p>
<ol>
  <li>ensuring the code has the <strong>correct behavior</strong> when given the proper input data.</li>
  <li>ensuring the <strong>code robustness</strong> to exceptions and invalid input data, meaning that it does not crash when it reaches unexpected situations during the code execution and gracefully handles the error, without interruption.</li>
</ol>

<p>Because of the goals for which the unit tests are designed, they are mostly written and used by the developers of the code.</p>

<h3 id="unit-test-frameworks">Unit test frameworks</h3>
<p>There are many ways to write tests for codes. Now, if you asked each software developer to write a unit test for a specific software, each would likely come up with their own set of rules and tests of the software. You will end up with many tests, that will generally only be usable by the developer that wrote the tests. That is why you should select a unit test framework. A unit test framework provides consistency for how the unit tests for your project are written. There are many test frameworks to choose from for just about any language you want to program with, including Python. Just like programming language, almost every programmer has a strong opinion which test framework is the best. Research what’s out there and use the one that meets the needs of your organization (For example, there is one experienced Python programmer in our ECL class who does not like any of the existing unit tests for Python, and wants to write his own unit test as the project of this course!).</p>

<p>The framework will provide a consistent testing structure to create maintainable tests with reproducible results. From a product quality and business point of view, those are the most valuable reasons to use a unit test framework. When you write a code, you should also think of a quick and simple way to develop and verify your logic in isolation. Once you make sure you have it working solidly by itself, then you can proceed to integrate it into the larger project solutions with great confidence.</p>

<p>Python offers three unit testing frameworks,</p>
<ol>
  <li><a href="https://docs.python.org/2/library/unittest.html" target="_blank"><strong>unittest</strong></a> (Python’s standard unit testing framework)</li>
  <li><a href="http://nose.readthedocs.io/en/latest/index.html" target="_blank"><strong>nose</strong></a></li>
  <li><a href="https://docs.pytest.org/en/latest/" target="_blank"><strong>pytest</strong></a></li>
</ol>

<p>which automate as much as possible the process of testing all of your codes, whenever required. The last, <code class="highlighter-rouge">pytest</code> appears to be the most popular unit testing framework as of today.</p>

<h4 id="conventions-for-test-functions">Conventions for test functions</h4>
<p>The simplest way of using the testing frameworks (e.g., pytest or nose) is to write a set of test functions, scattered around in files, such that pytest or nose can automatically find and run all of these test functions. To achieve the goal, the test functions need to follow certain conventions:</p>
<ol>
  <li>The name of a test function starts with <code class="highlighter-rouge">test_</code>.</li>
  <li>A test function cannot take any arguments.</li>
  <li>Any test must be formulated as a boolean condition.</li>
  <li>An <code class="highlighter-rouge">AssertionError</code> exception is raised if the boolean condition is <code class="highlighter-rouge">False</code> (i.e., when the test fails).<br />
<br /></li>
</ol>

<h4 id="testing-function-accuracy">Testing function accuracy</h4>
<p>Suppose we have written the following function which runs the Newton’s method for solving an algebraic equation of the form $f(x)=0$, and we would like to write a test function that ensures its correct behavior.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">newton</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">dfdx</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1E-7</span><span class="p">):</span>
    <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span> <span class="c"># iteration counter</span>
    <span class="k">while</span> <span class="nb">abs</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="o">&gt;</span> <span class="n">eps</span><span class="p">:</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="n">dfdx</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">n</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">n</span>
</code></pre></div></div>
<p><br />
Our goal is to write a function that tests the validity of the output of the function for a special case for which we know the results a priori. In the case of the above code, the function output is a not a fixed result, but an approximate float number $x_0$ which satisfies the condition $f(x_0)&lt;\epsilon$ where $\epsilon$ is a prescribed number close to zero. Therefore, we have to first come up with a mathematical test input function to the function <code class="highlighter-rouge">newton</code>, for which we have calculated the correct answer a priori, and we want to make sure if the above code gives the same answer. Since the output of the function <code class="highlighter-rouge">newton</code> is a float that depends on the machine precision, we cannot expect the function to output the exact same result every time the code is run on any computer. Therefore, we have to define our test such that the function passes the test even if the result is not exactly what we expect, but still close enough to the correct answer. Here is an example test function for the above code using the <code class="highlighter-rouge">sin(x)</code> function as the test input function to <code class="highlighter-rouge">newton()</code>,</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">test_newton_sin</span><span class="p">():</span>
    
    <span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">sin</span><span class="p">,</span> <span class="n">cos</span><span class="p">,</span> <span class="n">pi</span>

    <span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">dfdx</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    
    <span class="n">x_ref</span> <span class="o">=</span> <span class="mf">0.000769691024206</span>
    <span class="n">f_x_ref</span> <span class="o">=</span> <span class="mf">0.000769690948209</span>
    <span class="n">n_ref</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">f_x</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="n">newton</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">dfdx</span><span class="p">,</span> <span class="n">x</span><span class="o">=-</span><span class="n">pi</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1E-2</span><span class="p">)</span>
    <span class="n">tol</span> <span class="o">=</span> <span class="mf">1E-15</span> <span class="c"># tolerance for comparing real numbers</span>
    <span class="k">assert</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x_ref</span> <span class="o">-</span> <span class="n">x</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">tol</span> <span class="p">,</span> <span class="s">"The test for the value of x_0 failed"</span> <span class="c"># is x correct?</span>
    <span class="k">assert</span> <span class="nb">abs</span><span class="p">(</span><span class="n">f_x_ref</span> <span class="o">-</span> <span class="n">f_x</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">tol</span> <span class="p">,</span> <span class="s">"The test for the function value failed"</span> <span class="c"># is f_x correct?</span>
    <span class="k">assert</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">3</span> <span class="p">,</span> <span class="s">"The test for the number of iterations failed"</span> <span class="c"># is f_x correct? # is n correct?</span>
</code></pre></div></div>
<p><br />
Note that in the above test function, the function name begins with <code class="highlighter-rouge">test_</code>, takes no arguments, and raises an <code class="highlighter-rouge">assertionError</code> at the end. Now if you run the test,</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">test_newton_sin</span><span class="p">()</span>
</code></pre></div></div>
<p><br />
you will notice that the function passed the test. However, if in the above test, we set <code class="highlighter-rouge">eps=1E-10</code>, and run the test again, you will get an assertion error like the following,</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">---------------------------------------------------------------------------</span>
<span class="nb">AssertionError</span>                            <span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">)</span>
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">20</span><span class="o">-</span><span class="mi">8</span><span class="n">be9faac8d8e</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span><span class="p">()</span>
<span class="o">----&gt;</span> <span class="mi">1</span> <span class="n">test_newton_sin</span><span class="p">()</span>

<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">18</span><span class="o">-</span><span class="mi">263651</span><span class="n">ba410f</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="n">test_newton_sin</span><span class="p">()</span>
     <span class="mi">14</span>     <span class="n">x</span><span class="p">,</span> <span class="n">f_x</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="n">newton</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">dfdx</span><span class="p">,</span> <span class="n">x</span><span class="o">=-</span><span class="n">pi</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1E-10</span><span class="p">)</span>
     <span class="mi">15</span>     <span class="n">tol</span> <span class="o">=</span> <span class="mf">1E-15</span> <span class="c"># tolerance for comparing real numbers</span>
<span class="o">---&gt;</span> <span class="mi">16</span>     <span class="k">assert</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x_ref</span> <span class="o">-</span> <span class="n">x</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">tol</span> <span class="p">,</span> <span class="s">"The test for the value of x_0 failed"</span> <span class="c"># is x correct?</span>
     <span class="mi">17</span>     <span class="k">assert</span> <span class="nb">abs</span><span class="p">(</span><span class="n">f_x_ref</span> <span class="o">-</span> <span class="n">f_x</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">tol</span> <span class="p">,</span> <span class="s">"The test for the function value failed"</span> <span class="c"># is f_x correct?</span>
     <span class="mi">18</span>     <span class="k">assert</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">3</span> <span class="p">,</span> <span class="s">"The test for the number of iterations failed"</span> <span class="c"># is f_x correct? # is n correct?</span>

<span class="nb">AssertionError</span><span class="p">:</span> <span class="n">The</span> <span class="n">test</span> <span class="k">for</span> <span class="n">the</span> <span class="n">value</span> <span class="n">of</span> <span class="n">x_0</span> <span class="n">failed</span>
</code></pre></div></div>
<p><br />
One could also write exact tests for the function <code class="highlighter-rouge">newton</code> which test for an exact result which is known a priori, for example a mathematical linear input function to <code class="highlighter-rouge">newton</code>.<br />
<br /></p>

<h4 id="testing-function-robustness">Testing function robustness</h4>
<p>The above <code class="highlighter-rouge">newton</code> function is very basic and suffers from several problems:</p>
<ul>
  <li>for divergent iterations it will iterate forever,</li>
  <li>it can divide by zero in f(x)/dfdx(x),</li>
  <li>it can perform integer division in f(x)/dfdx(x),</li>
  <li>it does not test whether the arguments have acceptable types and values.</li>
</ul>

<p>A more robust implementation dealing with these potential problems would look like the following:</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">Newton</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">dfdx</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1E-7</span><span class="p">,</span> <span class="n">maxit</span><span class="o">=</span><span class="mi">100</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">callable</span><span class="p">(</span><span class="n">f</span><span class="p">):</span> <span class="k">raise</span> <span class="nb">TypeError</span><span class="p">(</span> <span class="s">'f is </span><span class="si">%</span><span class="s">s, should be function or class with __call__'</span> <span class="o">%</span> <span class="nb">type</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">callable</span><span class="p">(</span><span class="n">dfdx</span><span class="p">):</span> <span class="k">raise</span> <span class="nb">TypeError</span><span class="p">(</span> <span class="s">'dfdx is </span><span class="si">%</span><span class="s">s, should be function or class with __call__'</span> <span class="o">%</span> <span class="nb">type</span><span class="p">(</span><span class="n">dfdx</span><span class="p">)</span> <span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">maxit</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span> <span class="k">raise</span> <span class="nb">TypeError</span><span class="p">(</span> <span class="s">'maxit is </span><span class="si">%</span><span class="s">s, must be int'</span> <span class="o">%</span> <span class="nb">type</span><span class="p">(</span><span class="n">maxit</span><span class="p">)</span> <span class="p">)</span>
    <span class="k">if</span> <span class="n">maxit</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span> <span class="k">raise</span> <span class="nb">ValueError</span><span class="p">(</span> <span class="s">'maxit=</span><span class="si">%</span><span class="s">d &lt;= 0, must be &gt; 0'</span> <span class="o">%</span> <span class="n">maxit</span> <span class="p">)</span>
    <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span> <span class="c"># iteration counter</span>
    <span class="k">while</span> <span class="nb">abs</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="o">&gt;</span> <span class="n">eps</span> <span class="ow">and</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="n">maxit</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="n">dfdx</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="k">except</span> <span class="nb">ZeroDivisionError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="nb">ZeroDivisionError</span><span class="p">(</span> <span class="s">'dfdx(</span><span class="si">%</span><span class="s">g)=</span><span class="si">%</span><span class="s">g - cannot divide by zero'</span> <span class="o">%</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">dfdx</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="p">)</span>
        <span class="n">n</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">n</span>
</code></pre></div></div>
<p><br />
Now, for this more robust code (than the earlier version: <code class="highlighter-rouge">newton</code>), we have to also write a set of tests, examining the robustness of the code, subject to potential exceptions. For example, one can write a test function that examines the behavior of <code class="highlighter-rouge">Newton</code> subject to an input mathematical function that is known to lead to divergent (infinite) iterations, if the initial starting point $x$ is not sufficiently close to the root of the function. One such example is $f(x)=tanh(x)$, for which a starting search value of $x=20$ would lead to infinite iterations in the Newton’s method. So we can set <code class="highlighter-rouge">maxit=12</code> in our robust <code class="highlighter-rouge">Newton</code> code, and test that the actual number of iterations reaches this limit. Given our prior knowledge for this function, that the value of $x$ will also diverge after 12 iterations, we could also add a test for the value of $x$, like the following,</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">test_Newton_divergence</span><span class="p">():</span>
    <span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">tanh</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">tanh</span>
    <span class="n">dfdx</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mf">10.</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    
    <span class="n">x</span><span class="p">,</span> <span class="n">f_x</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="n">Newton</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">dfdx</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1E-4</span><span class="p">,</span> <span class="n">maxit</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">12</span>
    <span class="k">assert</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="mf">1E+50</span>
</code></pre></div></div>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">test_Newton_divergence</span><span class="p">()</span>
</code></pre></div></div>
<p><br />
The example given here, only tests for the robustness of <code class="highlighter-rouge">Newton()</code> in handling divergent situations. For other potential problems, one has to write other test functions, some which will be given as exercise.</p>

<h3 id="summary-unit-testing">Summary: unit testing</h3>
<p>Unit testing is a component of <a href="https://en.wikipedia.org/wiki/Test-driven_development" target="_blank">test-driven development (TDD)</a>, a pragmatic methodology that takes a meticulous approach to building a product by means of <em>continual testing and revision</em>.</p>

<p>Unit testing has a steep learning curve. The development team needs to learn what unit testing is, how to unit test, what to unit test and how to use automated software tools to facilitate the process on an on-going basis.  The great benefit to unit testing is that the earlier a problem is identified, the fewer compound errors occur. A compound error is one that doesn’t seem to break anything at first, but eventually conflicts with something down the line and results in a problem.</p>

<p>There is a lot more to unit testing and the existing Python frameworks for it than we discussed here. However, covering all those topics would require a dedicated course for unit testing, which is certainly beyond the capacity of this course. But if you are interested to know more, I recommend you to refer to one of the three unit testing frameworks mentioned <a href="#unit-test-frameworks">above</a>. There are also books already written on this topic an example of which is available <a href="http://chimera.labs.oreilly.com/books/1234000000754/pr01.html" target="_blank">here</a>.</p>

<p><br /><br /></p>

    </div>



</article>



    <div id="disqus_thread"></div>
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'shahmoradi'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>




<hr class="shaded"/>

<footer>
    <div class="row">
        <div class="col-lg-12 footer">
            &copy;2019 <a href="https://www.cdslab.org" target="_blank">Computational Data Science Lab</a><br />
         Site last generated: Jul 14, 2019 <br />
        <p>
            <img class="footerlogo" src="/python/images/logo.png" }}" alt="cdslab.org" />
        </p>
        </div>
    </div>
</footer>


        </div>
    <!-- /.row -->
</div>
<!-- /.container -->
</div>
<!-- /#main -->
    </div>

</body>

</html>
